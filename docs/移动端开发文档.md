# 移动端开发文档

## 项目概述

**项目名称：** 代拿网移动端

**开发目标：** 构建档口批发电商移动端应用，整合推荐系统，提供专业的批发代发服务体验

**设计参考：**
- UI风格：淘宝移动端（橙色/红色主题）
- 功能布局：京东移动端
- 业务特色：52华强北批发平台

**代码迁移策略：**
- 当前：src/ 为响应式混合代码（临时状态）
- 目标：apps/mobile/ 提取移动端专用代码，apps/pc/ 提取PC端专用代码
- 最终：删除 src/ 目录，实现完全分离

## 技术架构

### 前端技术栈
- **框架：** Next.js (App Router)
- **样式：** Tailwind CSS + CSS Modules
- **状态管理：** React Context + SWR/React Query
- **组件库：** 自研组件 + Ant Design Mobile
- **动效：** Framer Motion

### 项目结构
```
/apps/mobile/
├── public/          # 静态资源
├── src/
│   ├── app/         # 页面路由
│   ├── components/  # 组件
│   ├── hooks/       # 自定义hooks
│   ├── services/    # API服务
│   ├── styles/      # 全局样式
│   └── utils/       # 工具函数
```

## 页面规划

### 底部Tab导航页面（移动端专用）
1. **首页 (Home)** - 轮播图、快捷入口、档口推荐、商品推荐
2. **档口 (Market/Booths)** - 档口列表、档口详情（从src/迁移并优化）
3. **商务合作** - 批发代发合作、招商加盟
4. **我的 (Profile)** - 个人中心，登录后显示个性化推荐

### 二级页面
1. **商品详情页**
2. **档口详情页**
3. **搜索结果页**
4. **排行榜页**
5. **登录/注册页**
6. **订单管理页**

## API接口对接

### 推荐系统接口
| 页面位置 | 调用接口 | 功能描述 |
|---------|----------|---------|
| 首页轮播图 | `/public/homepage/banners` | 获取首页轮播图 |
| 热门档口 | `/public/homepage/booth-recommendations?type=booth_hot` | 热门档口推荐 |
| 热门商品 | `/public/homepage/product-recommendations?type=product_hot` | 热门商品推荐 |
| 个性化推荐 | `/api/recommendations/mixed?targetType=product` | 登录用户个性化推荐 |

### 用户行为追踪
- 实现`/api/behavior/record`接口调用，记录用户点击、浏览、收藏等行为

## 开发阶段与时间线

| 阶段 | 工作内容 | 时间周期 | 状态 |
|-----|----------|---------|------|
| 一 | 基础框架搭建 + 底部Tab导航 | 1周 | 🔄 进行中 |
| 二 | 首页开发 (当前重点) | 2周 | 🔄 进行中 |
| 三 | 档口页面迁移与优化 | 1.5周 | ⏳ 待开始 |
| 四 | 个人中心与推荐系统 | 2周 | ⏳ 待开始 |
| 五 | 商务合作页面开发 | 1周 | ⏳ 待开始 |
| 六 | 性能优化与测试 | 1周 | ⏳ 待开始 |

## 组件设计

### 核心组件

```
components/
├── common/          # 通用组件
│   ├── Button/
│   ├── Card/
│   └── Badge/
├── layout/          # 布局组件
│   ├── Header/
│   └── TabBar/
├── business/        # 业务组件
│   ├── ProductCard/
│   ├── BoothCard/
│   └── SearchBar/
└── home/            # 首页专用组件
    ├── Banner/
    ├── CategoryNav/
    └── RecommendSection/
```

### 组件规范
- 所有组件使用TypeScript开发，提供完整类型定义
- 组件支持自定义主题色
- 使用CSS Modules避免样式冲突

## 性能优化策略

1. **图片优化**
   - 使用Next.js内置的图片优化
   - 实现图片懒加载

2. **骨架屏**
   - 实现核心组件的加载占位

3. **接口优化**
   - SWR实现数据缓存
   - 首屏关键数据预加载

4. **代码优化**
   - 组件懒加载
   - 路由预加载
   - 代码分割

## 测试策略

1. **组件测试**
   - 使用Jest + React Testing Library

2. **端到端测试**
   - 使用Cypress进行关键流程测试

3. **兼容性测试**
   - 针对主流移动设备和浏览器

## 上线与监控

1. **灰度发布策略**
2. **性能监控指标**
3. **错误跟踪方案**

## 风险与应对策略

1. **性能瓶颈**：实现虚拟滚动，减少DOM节点
2. **个性化推荐失效**：降级至通用推荐
3. **图片加载缓慢**：实现智能预加载和压缩

## 设计原型参考

各主要页面设计参考淘宝、京东和52华强北的UI风格与交互方式，融合以下特点：
- 淘宝的搜索栏与色彩系统
- 京东的分类导航与商品展示
- 52华强北的排行榜与代发功能

## 后续迭代计划

1. **第一阶段上线**：基础购物功能
2. **第二阶段迭代**：社交功能与内容运营
3. **第三阶段优化**：算法优化与个性化提升 